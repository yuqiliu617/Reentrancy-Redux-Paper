\input{multimedias/misconception-table}

\section{Discussion}

We first examine common misconceptions about reentrancy attacks, followed by an evaluation of two prevalent mitigation techniques. We then propose research guidelines based on our findings, and explore additional perspectives, including reentrancy on non-EVM-compatible blockchains, applicability of our methodology to other attacks, and a victim-centric view of vulnerabilities. Finally, we outline the threats to the validity.


\subsection{Reentrancy Attacks: Myths and Reality}

Our qualitative and quantitative analyses reveal persistent misconceptions about reentrancy attacks in both academic and industrial contexts. In research, these misconceptions lead to limited detection efficacy in real-world scenarios; in practice, they may result in design flaws that expose contracts to exploitation. Table~\ref{tab:2} summarizes these myths and the corresponding realities.
%
However, many misconceptions do not stem from negligence. Most widely cited static analysis tools were developed before 2020, when only a few real-world attacks had occurred. These tools could not have anticipated the sophisticated strategies adopted by modern attackers.


\subsection{Mitigation Techniques}
\label{discussion:mitigation}

The two most commonly adopted techniques to mitigate reentrancy attacks are the checks-effects-interactions (CEI) pattern~\cite{checks-effects-interactions} and reentrancy guard~\cite{reentrancy-guard}. However, both approaches have inherent limitations as we describe below.

\textbf{Reentrancy Guard:} This method applies a modifier that reverts transactions when protected functions are recursively invoked. It is effective for single-function reentrancy but less so for cross-contract or higher-scoped cases. Its protection scope depends on implementation: guards deployed in a shared base contracts offer broader coverage than those directly embedded within single Solidity contracts\footnote{An on-chain contract with a unique address is typically linked from multiple contracts in Solidity source code.}. Our quantitative analysis shows that while 65.8\% of incidents could be prevented by reentrancy guards, this rate drops to 51.4\% after 2023. Notably, cross-contract and higher-scoped attacks, though less frequent, account for 57.2\% of total fund losses.

\textbf{CEI Pattern:} The CEI pattern advises developers to update state variables (effects) before making external calls (interactions), ensuring that the contract's state remains consistent when the execution flow is transferred to other contracts. This is the most common approach to address reentrancy vulnerabilities after an attack. However, in some cases, the contract's business logic necessitates using state differences before and after interactions, rendering the CEI pattern impractical. 


\subsection{Guidelines for Future Research}

The discrepancies between common misconceptions and the observed realities of reentrancy attacks, as revealed through our analyses, highlights several critical directions for future research in this domain. We outline three key areas that demand renewed attention.

First, the persistent prevalence of reentrancy attacks underscores a continuing arms race between attackers and defenders (developers, auditors, and researchers). The diminishing effectiveness of established mitigation techniques—evidenced by a decrease in the proportion of attacks preventable by reentrancy guards from 81.6\% before 2023 to 51.4\% after 2023—further emphasizes the continued need for ongoing research and development in reentrancy prevention.

Second, the evolution of attack strategies has rendered many early assumptions obsolete—particularly those published before 2020. Future work must move beyond fixed entry points such as the \lstinline{fallback} function and avoid presuming which token standards are likely to be targeted. Reentrancy now spans a broad range of token types and frequently co-occurs with other vulnerabilities, including access control flaws (see Section~\ref{qualitative:insufficient-access-control}) and over-reliance on external price oracles~\cite{attack-report:marketxyz,attack-report:midas-capital,attack-report:sentiment}.  Researchers should move on from viewing reentrancy not just as a means of draining funds through recursion, but also as a mechanism for exploiting broader security vulnerabilities.

Third, the increasing adoption of reentrancy as a deliberate programming pattern to enhance code flexibility warrants careful consideration. This trend blurs the purpose of reentrancy, transforming it from a clear indicator of vulnerability to a more ambiguous characteristic. This shift necessitates that future tools distinguish between malicious exploits and legitimate uses of reentrancy to avoid false-positives.


\subsection{Reentrancy on Non EVM-Compatible Blockchains}

While most blockchains adopt EVM compatibility for Ethereum interoperability, some platforms introduce new architectures to address EVM limitations, such as high transaction fees, low throughput, and high latency. Solana and EOS are two notable examples.

Solana, often referred to as an ``Ethereum killer'', has made significant strides in transaction speed, fee optimization, and scalability~\cite{solana-vs-ethereum}. To mitigate the risk of reentrancy attacks, Solana prohibits recursion into the same program~\cite{solana-security}. Although this design choice reduces the flexibility of its smart contracts—for instance, proxy contracts and flashloans are largely limited—it enhances the network's credibility.

EOS, which supports smart contracts written in C++, also offers better scalability and flexibility. However, its reputation has suffered due to centralized governance and unmet promises. Unlike Solana, which addresses reentrancy at the design level, EOS remains vulnerable to reentrancy attacks. On May 14, 2021, a reentrancy exploit on EOS led to a \$13 million loss~\cite{attack-report:sx}. Despite lacking a \lstinline{fallback} function, EOS's message-passing model introduces similar vulnerabilities.


\subsection{Applicability of Methodology to Other Blockchain Attacks}

Our analysis relies primarily on the call traces of exploit transactions, which only include cross-contract operations such as \lstinline{CALL}, \lstinline{DELEGATECALL}, \lstinline{STATICCALL}, and \lstinline{CREATE}. Since reentrancy is inherently a cross-contract phenomenon, call traces are sufficient for detecting these attacks and locate the vulnerabilities.
However, this approach does not generalize to many other vulnerability classes. For example, issues like integer overflow/underflow, timestamp dependency, and insufficient input validation typically occur within the internal logic of a single contract—below the granularity of the call trace. Although tools like Tenderly~\cite{tenderly} support opcode-level inspection, such low-level traces are impractical to analyze at scale. Source code access becomes essential in these cases, but is  not always available. In contrast, while Solidity source code enhances our analysis, it is not  required; we successfully analyzed five incidents in our dataset using only call traces.

Furthermore, reentrancy is defined by clear signatures. By comparison, vulnerabilities like access control flaws or general logic bugs—top categories in OWASP's 2025 list~\cite{top-smart-contract-attacks-2025}—are more abstract and context-dependent, making them harder to detect and categorize without deep semantic understanding and source code access. Attacks unrelated to contract logic, such as phishing, fall outside our methodology, as their root causes lie off-chain and require a different investigative approach.


\subsection{Root Cause Analysis on Victim Contracts}

Although this study adopts an attacker-centric view, analyzing vulnerabilities from the victim's perspective is equally important for prevention. During transaction analysis (Section~\ref{methodology:transaction-analysis}), we identify root causes when source code is available, and we find that exploitable reentrancy vulnerabilities typically stem from a combination of two factors:
\begin{enumerate*}
    \item flawed logic that updates states \textit{after} external calls (violating the CEI pattern), and
    \item failure to account for malicious execution during seemingly benign transfer actions or underestimation of malicious intent in explicit external calls.
\end{enumerate*}
Both conditions are equally necessary for successful exploitation. Although best practices advocate addressing both, developers often prioritize the second, as the increasing demand for flexibility often conflicts with the strict constraints of the CEI pattern. This tradeoff motivated our investigation of reentrancy entry points.

As for complete root cause analysis, it requires source code, commit histories, and audit records—resources often unavailable~\cite{wang2023empirical}. Moreover, as discussed in Section~\ref{quantitative:vulnerability-origin}, vulnerabilities may originate in upstream dependencies rather than the victim contract itself. Tracing the origin of forked code and locating where the vulnerability is introduced is challenging without a systematic method for tracking project lineage. The identification of origins in Section~\ref{quantitative:vulnerability-origin} relied on the researchers' prior knowledge and is  likely incomplete.


\subsection{Threats to Validity}

An external threat is potential dataset bias, as our reentrancy attack data was sourced from publicly available repositories, which favor high-profile cases. Smaller-loss attacks might receive less attention and thus be underrepresented. We mitigate this by compiling data from multiple sources~\cite{reentrancy-list-pcaversaccio, blocksec-security-incidents, slowmist-hacked}. This challenge is not unique to our study; for instance, BlockWatchdog~\cite{turn-the-rudder} also excludes attacks with losses below \$100,000.

 An internal threat is potential analysis bias, as both co-authors analyzed attack transactions using the same tools (BlockSec Phalcon Explorer~\cite{blocksec-security-incidents} and Tenderly Explorer~\cite{tenderly}) and reference materials (incident reports, victim post-mortems, and X/Twitter posts).  Reliance on similar resources could introduce bias.  To address this, we employed diverse sources and cross-validated findings (see Section~\ref{methodology:cross-validation}).